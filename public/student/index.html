<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Attendance Pass</title>
  <link rel="stylesheet" href="/design-system.css">
  <link rel="stylesheet" href="/student/styles.css">
</head>

<body>
  <header class="app-header">
    <div class="brand">Attendance</div>
    <div class="session-badge" id="sessionLabel">Loading...</div>
  </header>

  <main>
    <!-- State 1: Scanner -->
    <section id="scannerSection" class="card scanner-card animate-fade-in">
      <video id="video" autoplay muted playsinline webkit-playsinline></video>
      <div class="scanner-overlay">
        <div class="scan-guide"></div>
        <p class="text-muted text-sm" id="scannerStatus">Align QR code to verify</p>
        <button id="startScanBtn" class="btn btn-primary" style="margin-top: 16px;">Start Camera</button>
      </div>
    </section>

    <!-- State 2: ID Input (Hidden by default) -->
    <section id="inputSection" class="card animate-slide-up hidden">
      <h2 class="text-lg font-bold text-center mb-2">Almost there</h2>
      <p class="text-muted text-center text-sm mb-4">Enter your Student ID to finish</p>

      <div class="id-input-group">
        <input type="tel" id="studentIdInput" class="input-field" placeholder="90000000" maxlength="8" pattern="[0-9]*">
      </div>
      <button id="submitIdBtn" class="btn btn-primary" style="width: 100%; margin-top: 16px;">Submit</button>
    </section>

    <!-- State 3: Pass Card (Hidden by default) -->
    <section id="passCard" class="card pass-card animate-slide-up hidden">
      <div class="pass-header">
        <div class="pass-icon">âœ“</div>
        <div class="pass-time">
          <div class="label">Checked In</div>
          <div class="value" id="passTime">--:--</div>
        </div>
      </div>
      <div class="pass-details">
        <div class="detail-row">
          <span class="detail-label">Module</span>
          <span class="detail-value font-mono" id="passModule">--</span>
        </div>
        <div class="detail-row">
          <span class="detail-label">Student ID</span>
          <span class="detail-value font-mono" id="passStudentId">--</span>
        </div>
        <div class="detail-row">
          <span class="detail-label">Date</span>
          <span class="detail-value" id="passDate">--</span>
        </div>
      </div>
    </section>

    <!-- Manual Override (Collapsible) -->
    <div class="text-center mt-4">
      <button id="manualOverrideBtn" class="btn btn-ghost text-sm">Having trouble?</button>
    </div>

    <!-- Manual Override Form (Hidden) -->
    <section id="manualOverrideSection" class="card animate-slide-up hidden" style="margin-top: 16px;">
      <h3 class="text-sm font-bold uppercase text-muted mb-2">Manual Verification</h3>
      <p class="text-sm text-muted mb-4">Ask your teacher to enter the session password.</p>
      <div class="id-input-group">
        <input type="password" id="manualOverridePassword" class="input-field" placeholder="Password">
      </div>
      <button id="manualOverrideSubmitBtn" class="btn btn-primary"
        style="width: 100%; margin-top: 16px;">Verify</button>
      <p id="manualOverrideStatus" class="text-center text-sm mt-2 text-muted"></p>
    </section>

    <!-- History -->
    <section id="historySection" class="history-section hidden">
      <h3 class="history-title">Recent Passes</h3>
      <div id="historyList" class="history-list">
        <!-- History items will be injected here -->
      </div>
    </section>
  </main>

  <script src="/student/jsqr.min.js"></script>
  <script src="/student/student.js"></script>
</body>

</html>