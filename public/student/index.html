<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>In-Class Attendance</title>
  <link rel="stylesheet" href="/student/styles.css">
</head>
<body>
  <div class="page">
    <header class="page__header">
      <div>
        <p class="session-label" id="sessionLabel">Live session</p>
        <h1 id="sessionTitle">Attendance Check-in</h1>
      </div>
    </header>

    <main class="page__grid">
      <section class="card intro">
        <h2>Complete both steps to confirm you are in class</h2>
        <ol class="steps">
          <li><strong>Step 1:</strong> You already scanned the entry QR to open this page.</li>
          <li><strong>Step 2:</strong> Use the scanner below to read the verification code on the front screen.</li>
        </ol>
      </section>

      <section class="card scanner" id="scannerCard">
        <h2>Step 2 – Verify attendance</h2>
        <div class="scanner-placeholder" id="scannerPlaceholder">
          <p>Tap “Start scanning” to open the camera.</p>
          <p class="muted small">If the QR is not detected quickly, wait for the next refresh while keeping the QR-code in the frame.</p>
        </div>
        <div class="camera-frame" id="cameraFrame" hidden>
          <video id="video" autoplay muted playsinline webkit-playsinline></video>
          <div class="camera-overlay">
            <div class="bracket top-left"></div>
            <div class="bracket top-right"></div>
            <div class="bracket bottom-left"></div>
            <div class="bracket bottom-right"></div>
            <p class="camera-hint" id="cameraHint">Align the QR inside the frame</p>
          </div>
        </div>
        <button class="primary" id="scanBtn">Start scanning</button>
        <p class="muted small" id="scannerStatus" role="status" aria-live="polite"></p>
        <div class="card success" id="successCard" hidden>
          <span class="success-icon">✔</span>
          <div>
            <h3>Presence verified</h3>
            <p class="muted">Great! Now enter your student ID to finish the check-in.</p>
          </div>
        </div>
      </section>

      <section class="card form" id="idCard" hidden>
        <h2>Finalize your check-in</h2>
        <label for="student-id">Student ID</label>
        <div class="id-input-row">
          <input type="text" id="student-id" maxlength="8" placeholder="Enter your student ID" inputmode="numeric" pattern="9\d{7}">
          <button class="primary" id="submit-btn">Submit</button>
        </div>
        <p class="muted small" id="submitStatus"></p>
      </section>
    </main>
  </div>

  <script src="/student/jsqr.min.js"></script>
  <script src="/student/student.js"></script>
</body>
</html>
